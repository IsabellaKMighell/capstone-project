(this["webpackJsonpreact-rails-api-project-template-client"]=this["webpackJsonpreact-rails-api-project-template-client"]||[]).push([[0],{142:function(e,t,n){},143:function(e,t,n){},156:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n.n(s),a=n(49),i=n.n(a),r=(n(142),n(19)),o=(n(143),n(17)),l=n(169),u=n(2);var j=function(e){var t=e.handleLogout;return e.user,Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{children:[Object(u.jsx)(o.b,{to:"/consumers",children:Object(u.jsx)(l.a,{children:"Home"})}),Object(u.jsx)(o.b,{to:"/",onClick:t,children:Object(u.jsx)(l.a,{children:"Logout"})}),Object(u.jsx)(o.b,{to:"/login",children:Object(u.jsx)(l.a,{children:"Login"})})]})})},d=n(63),b=n(71),h=n(168);var O=function(e){var t=e.setUser,n=Object(s.useState)({username:"",password:"",user:""}),c=Object(r.a)(n,2),a=c[0],i=c[1];function j(e){var t=e.target.name,n=e.target.value;i(Object(b.a)(Object(b.a)({},a),{},Object(d.a)({},t,n)))}var O=Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Create an account"}),Object(u.jsxs)(h.a,{onSubmit:function(e){e.preventDefault(),fetch("/".concat(a.user,"_signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a.username,password:a.password})}).then((function(e){return e.json()})).then((function(e){t(e)})),i({username:"",password:"",user:"consumer"})},children:[Object(u.jsxs)(h.a.Field,{children:[Object(u.jsx)("label",{children:"Username"}),Object(u.jsx)("input",{type:"text",placeholder:"Username",name:"username",value:a.username,onChange:j})]}),Object(u.jsxs)(h.a.Field,{children:[Object(u.jsx)("label",{children:"Password"}),Object(u.jsx)("input",{type:"text",placeholder:"Password",name:"password",value:a.password,onChange:j})]}),Object(u.jsx)(l.a,{type:"submit",children:"Submit"})]})]});return Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{children:O}),Object(u.jsxs)("div",{children:["Already have an account?",Object(u.jsx)(o.b,{to:"/login",children:Object(u.jsx)("button",{children:"Login"})})]})]})};var x=function(e){var t=e.setUser,n=Object(s.useState)({username:"",password:"",user:"consumer"}),c=Object(r.a)(n,2),a=c[0],i=c[1],j=Object(s.useState)(null),O=Object(r.a)(j,2),x=O[0],m=O[1];function g(e){var t=e.target.name,n=e.target.value;i(Object(b.a)(Object(b.a)({},a),{},Object(d.a)({},t,n)))}var f=Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Login"}),Object(u.jsxs)(h.a,{onSubmit:function(e){e.preventDefault(),fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:a.user,username:a.username,password:a.password})}).then((function(e){e.ok?e.json().then((function(e){t(e)})):e.json().then((function(e){m(e.errors),console.log(x)}))})),i({username:"",password:"",user:""})},children:[Object(u.jsxs)(h.a.Field,{children:[Object(u.jsx)("label",{children:"Username"}),Object(u.jsx)("input",{type:"text",placeholder:"Username",name:"username",value:a.username,onChange:g})]}),Object(u.jsxs)(h.a.Field,{children:[Object(u.jsx)("label",{children:"Password"}),Object(u.jsx)("input",{type:"text",placeholder:"Password",name:"password",value:a.password,onChange:g})]}),Object(u.jsx)(l.a,{type:"submit",children:"Submit"})]})]});return Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{children:f}),Object(u.jsx)(o.b,{to:"/new_user",children:Object(u.jsx)(l.a,{children:"Create an Account"})}),Object(u.jsx)(u.Fragment,{})]})},m=n(10);var g=function(e){var t=e.setUser,n=e.user,s=e.ADMIN;return Object(u.jsxs)(m.c,{children:[Object(u.jsx)(o.a,{path:"/login",children:Object(u.jsx)(x,{setUser:t,ADMIN:s,user:n})}),Object(u.jsx)(o.a,{exact:!0,path:"/new_user",children:Object(u.jsx)(O,{setUser:t,ADMIN:s,user:n})})]})};var f=function(e){var t=e.id,n=e.name,s=e.address,c=e.logo,a=e.handleIndividualBusiness;return Object(u.jsxs)("div",{className:"businessesDiv",children:[Object(u.jsx)("img",{src:c,alt:"Business Logo",className:"logo"}),Object(u.jsxs)(o.b,{to:"/business_page",children:[Object(u.jsx)(l.a,{onClick:function(){return a(t)},children:n})," "]}),Object(u.jsx)("h4",{children:s})]})};var p=function(e){var t=e.businesses,n=e.handleIndividualBusiness,s=t.map((function(e){return Object(u.jsx)(f,{id:e.id,name:e.name,latitude:e.latitude,longitude:e.longitude,address:e.address,logo:e.image,handleIndividualBusiness:n},e.id)}));return Object(u.jsx)("div",{className:"listsDiv",children:s})};var v=function(e){var t=e.businesses,n=e.handleIndividualBusiness;return Object(u.jsxs)("div",{children:[Object(u.jsx)("h2",{children:"Welcome to line succession"}),Object(u.jsx)(p,{businesses:t,handleIndividualBusiness:n})]})};var S=function(e){var t=e.business_line,n=1e3*e.lineItem.time,s=setInterval(function(){var e=0;if(t!==[e]){var n=t[e].id;fetch("/lines/".concat(n),{method:"DELETE"}),e+=1}else clearInterval(s)}(),n);return Object(u.jsx)(u.Fragment,{})};var w=function(e){var t=e.business,n=e.lat,c=e.long,a=t.id,i=t.name,o=t.longitude,j=t.latitude,d=t.image,b=t.address,h=t.waittime,O=t.business_line,x=Object(s.useState)(null),m=Object(r.a)(x,2),g=m[0],f=m[1],p=Object(s.useState)(null),v=Object(r.a)(p,2),w=v[0],I=v[1],y=n*Math.PI/180,M=j*Math.PI/180,C=(j-n)*Math.PI/180,F=(o-c)*Math.PI/180,P=Math.sin(C/2)*Math.sin(C/2)+Math.cos(y)*Math.cos(M)*Math.sin(F/2)*Math.sin(F/2),L=2*Math.atan2(Math.sqrt(P),Math.sqrt(1-P)),N=Number((6371e3*L).toFixed(4));return console.log(O),console.log("Distance from Business: ".concat(N)),Object(u.jsxs)("div",{children:[Object(u.jsx)("img",{src:d,alt:"Business Logo",className:"logo"}),Object(u.jsx)("h3",{children:i}),Object(u.jsx)("h4",{children:b}),Object(u.jsxs)("h4",{children:["The current approximated wait time for ",i," is ",h/60," minutes"]}),w?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{children:"You're in line!"}),Object(u.jsx)(S,{business_line:O,lineItem:w})]}):Object(u.jsx)(l.a,{onClick:function(){fetch("/lines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({business_id:a,distance:N})}).then((function(e){e.ok?e.json().then((function(e){console.log(e),I(e)})):e.json().then((function(e){f(e.errors),console.log(g)}))}))},children:"Get in Line"})]})};var I=function(){var e=Object(s.useState)(null),t=Object(r.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(!1),i=Object(r.a)(a,2),o=i[0],l=i[1],d=Object(s.useState)([]),b=Object(r.a)(d,2),h=b[0],O=b[1],x=Object(s.useState)([]),f=Object(r.a)(x,2),p=f[0],S=f[1],I=Object(s.useState)(null),y=Object(r.a)(I,2),M=y[0],C=y[1],F=Object(s.useState)(null),P=Object(r.a)(F,2),L=P[0],N=P[1],D=Object(m.f)();return Object(s.useEffect)((function(){fetch("/businesses").then((function(e){return e.json()})).then((function(e){O(e)})).catch((function(e){console.log(e.message)})),fetch("/me").then((function(e){return e.json()})).then((function(e){c(e),console.log(e),console.log("RERENDER")})).catch((function(e){console.log(e.message)}))}),[o]),navigator.geolocation.getCurrentPosition((function(e){C(e.coords.latitude),N(e.coords.longitude)})),Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)("h1",{children:"Succession"}),Object(u.jsx)(j,{handleLogout:function(){fetch("/logout",{method:"DELETE"}).then((function(){c(null),console.log("".concat(n.username," logged out!")),l(!o),D.push("/login")}))},user:n}),Object(u.jsx)(g,{setUser:c,user:n}),Object(u.jsx)(m.a,{path:"/consumers",children:Object(u.jsx)(v,{businesses:h,user:n,handleIndividualBusiness:function(e){console.log(e),fetch("/businesses/".concat(e)).then((function(e){return e.json()})).then((function(e){console.log(e),S(e),l(!o)}))}})}),Object(u.jsx)(m.a,{path:"/business_page",children:Object(u.jsx)(w,{business:p,lat:M,long:L,user:n})})]})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,171)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),s(e),c(e),a(e),i(e)}))};n(155);i.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(o.a,{children:Object(u.jsx)(I,{})})}),document.getElementById("root")),y()}},[[156,1,2]]]);
//# sourceMappingURL=main.df11f702.chunk.js.map